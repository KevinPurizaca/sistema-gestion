<p-panel header="Busqueda de Registros" [toggleable]="true" (collapsedChange)="collapsedChange($event)"
    [collapsed]="false">
    <ng-template pTemplate="icons">
        <button *ngIf="isCollapsed" pButton label="Nuevo Registro" icon="pi pi-plus-circle"
            class="p-button-secondary p-button-xs p-button-outlined mr-2"></button>
    </ng-template>
    <form [formGroup]="formBusqueda">
        <div class="p-fluid p-formgrid grid">

            <div class="col-12 md:col-3">
                <label class="label-filter-text">Nombres</label>
                <!-- <input formControlName="txtNombre" type="text" pInputText 
              class="p-inputtext p-component p-element" />
            <small class="ng-dirty ng-invalid" *ngIf="formBusqueda.get('txtNombre')?.hasError('pattern')">Ingrese solo
              Letras</small> -->
            </div>

            <div class="col-12 md:col-3">
                <label class="label-filter-text">Apellido Paterno</label>
                <!-- <input formControlName="txtApellidoPaterno" type="text" pInputText 
              class="p-inputtext p-component p-element" />
            <small class="ng-dirty ng-invalid" *ngIf="formBusqueda.get('txtApellidoPaterno')?.hasError('pattern')">Ingrese solo
              Letras</small> -->
            </div>

            <div class="col-12 md:col-3">
                <label class="label-filter-text">Apellido Materno</label>
                <!-- <input formControlName="txtApellidoMaterno" type="text" pInputText 
              class="p-inputtext p-component p-element" />
            <small class="ng-dirty ng-invalid" *ngIf="formBusqueda.get('txtApellidoMaterno')?.hasError('pattern')">Ingrese solo
              Letras</small> -->
            </div>

            <div class="col-12 md:col-3">
                <label class="label-filter-text">Perfil</label>
                <!-- <p-dropdown formControlName="cboPerfil" [options]="lsperfilcb" optionLabel="value"
              optionValue="id" [emptyMessage]="vmessageEmpty">
            </p-dropdown> -->
            </div>

            <div class="col-12 md:col-3">
                <label class="label-filter-text">Nro Documento</label>
                <!-- <p-inputNumber class="p-inputtext p-component p-element" [maxlength]="20"
              formControlName="txtNroDocumento"  inputId="withoutgrouping"
              [useGrouping]="false" class="form-control" autocomplete="off"> </p-inputNumber>
    
            <small class="ng-dirty ng-invalid" *ngIf="formBusqueda.get('txtNroDocumento')?.hasError('pattern')">Ingrese solo
              Letras</small> -->
            </div>

            <div class="col-12 md:col-3">
                <label class="label-filter-text">Tipo Documento</label>
                <!-- <p-dropdown formControlName="cboTipoDocumento" [options]="lstipodocumentocb" optionLabel="value"
              optionValue="id" [emptyMessage]="vmessageEmpty">
            </p-dropdown> -->
            </div>

            <div class="col-12 md:col-2">
                <label class="label-filter-text">Estado</label>
                <!-- <p-dropdown formControlName="cboEstado" placeholder="Seleccione" [options]="lstestadocb"
             optionLabel="value" optionValue="id" [emptyMessage]="vmessageEmpty">
            </p-dropdown> -->
            </div>
        </div>



        <div class="flex flex-wrap sm:flex-row">
            <div class="sm:mr-auto mb-3 mr-3">
                <button pButton label="Nuevo Registro" type="button" icon="pi pi-plus"
                    (click)="showModal(null,'Registrar')" class="p-button-help"></button>
            </div>
            <div class="mb-3 mr-3">
                <button pButton label="Buscar" icon="pi pi-search" type="submit"
                    class="p-button-outlined p-button-primary"></button>
            </div>
            <div class="">
                <button pButton label="Limpiar" type="button" icon="pi pi-trash"
                    class="p-button-outlined p-button-secondary"></button>
            </div>
        </div>
    </form>
</p-panel>

<br>

<p-panel header="Resultado de Registros" [toggleable]="false">

    <p-table [value]="lstRegistros" styleClass="p-datatable-sm">
        <ng-template pTemplate="header">
            <tr>
                <th class="columna-carta"></th>
                <th class="columna-fecha">Fecha Registro</th>
                <th class="columna-cliente">Cliente</th>
                <th class="columna-carta">Registrado Por</th>
                <th class="columna-carta">Asunto</th>
                <th class="columna-ver-detallles"></th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-data>
            <tr>
                <td class="columna-carta">
                    <p-button icon="pi pi-envelope" [rounded]="false" [text]="true" [severity]="'warning'" />

                </td>
                <td class="columna-fecha">{{ data.fecha }}</td>
                <td class="columna-cliente">{{ data.cliente }}</td>
                <td class="columna-registrado">{{ data.registradoPor }}</td>
                <td class="columna-asunto">{{ data.asunto }}</td>
                <td class="columna-ver-detallles">
                    <p-button label="Ver Detalles" [text]="true" />


                </td>
            </tr>
        </ng-template>
    </p-table>


    <p-paginator (onPageChange)="onPageChange($event)" [first]="first" [rows]="rows" [totalRecords]="120"
        [rowsPerPageOptions]="[10, 20, 30]" />
</p-panel>




<p-dialog header="Nuevo Registro" [modal]="true" [(visible)]="bDialogRegistrarDetalle"
    [style]="{ width:'600px',height:'1000px' }" [closable]="true" [resizable]="true" [draggable]="false">



    <ng-template pTemplate="content">
        <form [formGroup]="formRegistro">
            <div class="p-fluid p-formgrid grid">

                <div class="col-12 md:col-12">
                    <label class="label-filter-text">Cliente</label>
                    <!-- <p-dropdown [options]="lstClientes" optionLabel="value" optionValue="id" placeholder="Seleccione" formControlName="cboCliente" appendTo="body" [filter]="true"/> -->
                    <p-autoComplete 
                    [(ngModel)]="selectedClientes" 
                    [dropdown]="false" 
                    [suggestions]="filtroClientes" 
                    (completeMethod)="filtrarClientes($event)" 
                    minLength="2"
                    placeholder="Seleccione Cliente"
                     />

                    <small *ngIf="formRegistro.controls['cboCliente'].invalid && formRegistro.controls['cboCliente'].touched"
                    class="text-red-600">Seleccione Cliente.</small>
                </div>

                <div class="col-12 md:col-12">
                    <label class="label-filter-text">Asunto</label>
                    <input type="text" pInputText formControlName="txtAsunto"/>

                    <small  *ngIf="formRegistro.controls['txtAsunto'].invalid && formRegistro.controls['txtAsunto'].touched"
                    class="text-red-600">Ingrese Asunto.</small>
                </div>

                <div class="col-12 md:col-12">
                    <label class="label-filter-text">Descripcion Detallada</label>
                    <textarea rows="4" cols="30" pInputTextarea formControlName="txtDescripcion"></textarea>

                    <small  *ngIf="formRegistro.controls['txtDescripcion'].invalid && formRegistro.controls['txtDescripcion'].touched"
                    class="text-red-600">Ingrese Descripcion Detallada.</small>
                </div>

                <div class="col-12 md:col-12">
                    <label class="label-filter-text">Comentario</label>
                    <textarea rows="4" cols="30" pInputTextarea formControlName="txtComentario"></textarea>

                    <small  *ngIf="formRegistro.controls['txtDescripcion'].invalid && formRegistro.controls['txtDescripcion'].touched"
                    class="text-red-600">Ingrese Comentario.</small>
                </div>

            </div>
        </form>

    </ng-template>

    <ng-template pTemplate="footer">

        <p-button label="Cerrar" severity="secondary" icon="pi pi-times" iconPos="right" size="small"
            (onClick)="bDialogRegistrarDetalle = false" />
        <p-button label="Enviar" severity="primary" icon="pi pi-send" iconPos="right" size="small" 
            (onClick)="guardarRegistro()"/>



    </ng-template>
</p-dialog>


<!-- [ngClass]="{'ng-invalid ng-dirty' : submitted && !lsusuariodto.iid_tipo_documento}"  -->